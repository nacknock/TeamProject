<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:layout=http://www.ultraq.net.nz/thymeleaf/layout
  layout:decorate="~{Admin/layouts/AdminPageLayout}">

<div layout:fragment="content">
  <main id="main" class="main"><!-- main 태그 : 머리(HEADER)-본문(MAIN)-끝(FOOTER) 중 본문 내용을 담는 태그 -->

    <!-- ======= Breadcrumbs : 포스트 제목과 smallNavi ======= -->
    <div class="pagetitle">
      <h1>Dashboard</h1><!-- 포스트 제목 -->
    </div>
    <!-- End Breadcrumbs -->

    <!-- ======= Post Main Section ======= -->
    <section class="section dashboard"><!-- page 구역(area) 나누는 태그-->
      <div class="row"> <!-- row : <div>등 태그를 수평으로 정렬하고 col 마다 패딩 간격을 줌-->
        <div class="col-lg-12"> <!-- 전체 박스(div : 큰 화면 기준으로 전체 사이즈)-->
          <div class="row"><!-- 상위 박스(div)의 태그들을을 row 함 -->

            <!-- BEGIN 카드 1 : 제품 수 -->
            <div class="col-xxl-4 col-md-6"> <!-- 매우 큰 화면에서는 3분의 1, 중간 화면에서는 절반만 보이게 -->
              <div class="card info-card sales-card"><!-- card : 카드 레이아웃, info/sales : 사용자 정의 카드 디자인 -->

                <!-- 카드1: title + icon + infoText-->
                <div class="card-body">
                  <h5 class="card-title">商品数</h5> <!-- 제목 -->
                  
                  <div class="d-flex align-items-center"><!-- 아이콘 및 텍스트 가운데 정렬 -->
                    <div class="card-icon rounded-circle d-flex align-items-center justify-content-center"> <!-- 아이콘 원형으로 만들기기-->
                      <i class="bi bi-cart"></i> <!-- 장바구니니 아이콘 -->
                    </div>

                    <!-- 카드1 : TEXT -->
                    <div class="ps-3"> <!-- ps-3 : 왼쪽 여백 3만큼 -->
                      <h6>[[${productCnt}]]</h6> <!-- 제품 수 -->
                    </div>

                  </div><!-- END 아이콘 및 텍스트 가운데 정렬 -->
                </div>
                <!-- END 카드1 : title + icon + text-->

              </div><!-- END 카드 디자인 -->
            </div><!-- END 화면별 크기 조절 -->
            <!-- END 카드 1 : 제품 수 -->

            <!-- BEGIN 카드 2 : 주문 수 -->
            <div class="col-xxl-4 col-md-6"> <!-- 매우 큰 화면에서는 3분의 1, 중간 화면에서는 절반만 보이게 -->
              <div class="card info-card revenue-card"> <!-- 카드 디자인 -->
                
                <!-- 카드2 내용 : 제목 + 아이콘 + infoText -->
                <div class="card-body">
                  <h5 class="card-title">注文数</h5> <!-- 카드 제목 -->

                  <div class="d-flex align-items-center"><!-- 아이콘 및 텍스트 가운데 정렬 -->
                    <div class="card-icon rounded-circle d-flex align-items-center justify-content-center"><!-- 아이콘 원형으로 만들기-->
                      <i class="bi bi-currency-dollar"></i> <!-- 달러 아이콘 -->
                    </div>

                    <!-- 카드 내용2 : TEXT -->
                    <div class="ps-3"><!-- 왼쪽 여백 3만큼 -->
                      <h6>[[${orderCnt}]]</h6> <!-- 총 주문 수 -->
                    </div>

                  </div><!-- END 아이콘 및 텍스트 가운데 정렬 -->
                </div>
                <!-- END 카드2 내용 -->
              
              </div><!-- END 카드 디자인 -->
            </div><!-- END 화면별 크기 조절 -->
            <!-- END 카드 2 : 주문 수 -->

            <!-- BEGIN 카드 3 : 고객 수 -->
            <div class="col-xxl-4 col-xl-12"> <!-- 매우 큰 화면에서는 3분의 1, 중간 화면에서는 절반만 보이게 -->
              <div class="card info-card customers-card"> <!-- 카드 디자인 -->
                
                <!-- 카드3 내용 : 제목 + 아이콘 + infoText -->
                <div class="card-body">
                  <h5 class="card-title">ユーザー数</h5><!-- 카드3 제목 -->

                  <div class="d-flex align-items-center"><!-- 아이콘 및 텍스트 가운데 정렬 -->
                    <div class="card-icon rounded-circle d-flex align-items-center justify-content-center"><!-- 아이콘 원형으로 만들기-->
                      <i class="bi bi-people"></i> <!-- 사람 아이콘 -->
                    </div>
                    
                    <!-- 카드3 내용 : TEXT -->
                    <div class="ps-3"><!-- 왼쪽 여백 3만큼 -->
                      <h6>[[${userCnt}]]</h6><!-- 총 회원 수 -->
                    </div>

                  </div><!-- END 아이콘 및 텍스트 가운데 정렬 -->
                </div>
                <!-- END 카드3 내용 -->

              </div><!-- END 카드 디자인 -->
            </div><!-- END 화면별 크기 조절 -->
            <!-- END 카드 3 : 고객 수 -->

            <!-- BEGIN 카드 4 : 문의 -->
            <div class="col-6"> <!-- 왼쪽 열 (50% 너비) -->
              <div class="card"> <!-- 카드 디자인 -->
                
                <!-- 카드4 : 제목 + 테이블 -->
                <div class="card-body"> 
                  <h5 class="card-title" style="margin-top: 15px;">お問い合わせ<span class="btn" style="float:right; border:1px solid #ccc;"
                                                           th:onclick="'location.href=\'/admin/qna/list.do' + '\' '">リストへ移動</span></h5> <!-- 제목 -->

                  <!-- 문의 사항 테이블 -->
                  <table class="table table-bordered"> <!-- 테이블 디자인 -->
                    <thead>
                      <tr>
                        <th scope="col">#</th>
                        <th scope="col">タイトル</th>
                        <th scope="col">回答</th>
                        <th scope="col">カテゴリ</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr th:each="questionList,iterStat : ${questionList}">
                        <th scope="row">[[${iterStat.index+1}]]</th>
                        <td th:if="${#strings.length(questionList.title) > 5}">
                          <span th:text="${questionList.title.substring(0, 5) + '...'}"></span>
                          <span th:if="${questionList.status}" class="badge badge-success" style="float:right;">返答済み</span>
                          <span th:if="${!questionList.status}" class="badge badge-success" style="background:#f00; float:right;">未回答</span>
                        </td>
                        <td th:if="${#strings.length(questionList.title) <= 5}">
                          <span th:text="${questionList.title}"></span>
                          <span th:if="${questionList.status}" class="badge badge-success" style="float:right;">返答済み</span>
                          <span th:if="${!questionList.status}" class="badge badge-success" style="background:#f00; float:right;">未回答</span>
                        </td>
                        <td>[[${#temporals.format(questionList.created_at, 'yyyy/MM/dd')}]]</td>
                        <td>[[${questionList.category}]]</td>
                      </tr>
                      
                      <!-- .. 추가 문의 항목 -->
                    
                    </tbody>
                  </table><!-- END 테이블 디자인 -->
                  <!-- END 문의 사항 테이블 -->
                
                </div>
                <!-- END 카드4 : 제목 + 테이블 -->
              </div><!-- END 카드 디자인 -->
            </div><!-- END 카드 4 -->

            <!-- BEGIN 카드 5 : 주문 비율 -->
            <div class="col-lg-6"> <!-- 큰 화면 사이즈의 50% 크기 -->
              <div class="card"> <!-- 카드 디자인 -->
                
                <!-- 카드5 : 제목 + Pie Chart -->
                <div class="card-body"> 
                  <h5 class="card-title">注文の比率</h5> <!-- 카드 제목 -->

                  <!-- 주문 비율 Pie Chart -->
                  <canvas id="pieChart" style="max-height: 400px;"></canvas>
                  <script th:inline="javascript">
                    document.addEventListener("DOMContentLoaded", () => {
                      let labelss = [];
                      let datase = [];
                      [# th:each="entry : ${orderRate}"]
                          labelss.push(JSON.parse('"' + [[${entry.key}]] + '"')); 
                          datase.push([[${entry.value}]]);
                      [/]
                      new Chart(document.querySelector('#pieChart'), {
                        type: 'pie',
                        data: {
                          labels: labelss,
                          datasets: [{
                            label: ['比率'],
                            data: datase,
                            hoverOffset: 4
                          }]
                        }
                      });
                    });
                  </script>
                </div>
                <!-- END 카드5 : 제목 + Pie Chart -->

              </div><!-- END 카드 디자인 -->
            </div><!-- END 카드 5 : 화면 크기기-->
            <!-- END 카드 5 : 주문 비율 -->

            <!-- BEGIN 카드 6 : 판매 상위 제품 -->
            <div class="col-12"> <!-- 100% 넓이-->
              <div class="card top-selling overflow-auto"> <!-- 카드 디자인 -->

                <!-- 카드6 header-left : 제목 / main : 상위 판매 테이블-->
                <div class="card-body pb-0">
                  <h5 class="card-title">一番売られた商品</h5><!-- 카드 제목 -->
                  
                  <!-- 상위 판매 테이블 -->
                  <table class="table table-borderless">
                    <thead>
                      <tr>
                        <th scope="col">イメージ</th> 
                        <th scope="col">商品</th>
                        <th scope="col">値段</th>
                        <th scope="col">販売者</th>
                        <th scope="col">販売量</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr th:each="list : ${topSellingList}">
                        <th scope="row"><a th:href="@{/admin/product/detail.do(id=list.key.id)}"><img th:src="${list.key.thumbnail_url}" alt=""></a></th> <!-- 미리보기 이미지 -->
                        <td th:if="${#strings.length(list.key.title) > 20}">
                          <a class="text-primary fw-bold" th:href="@{/admin/product/detail.do(id=${list.key.id})}"
                             th:text="${list.key.title.substring(0, 20) + '...'}"></a>
                        </td>
                        <td th:if="${#strings.length(list.key.title) <= 20}">
                          <a class="text-primary fw-bold" th:href="@{/admin/product/detail.do(id=${list.key.id})}"
                             th:text="${list.key.title}"></a>
                        </td>
                        <td>[[${list.key.price}]]円</td> <!-- 제품 가격 -->
                        <td class="fw-bold">[[${list.key.seller_id.company_name}]]</td><!-- 판매자 -->
                        <td class="fw-bold">[[${list.value}]]</td><!-- 판매량 -->
                      </tr>
                      
                      <!-- 항목/ 제품 추가 코드
                      <tr>
                        <th scope="row"><a href="#"><img src="assets/img/product-2.jpg" alt=""></a></th>
                        <td><a href="#" class="text-primary fw-bold">Doloremque aperiam</a></td>
                        <td>$64</td>
                        <td class="fw-bold">124</td>
                        <td>$5,828</td> 
                      </tr>
                        -->
                    
                    </tbody>
                  </table><!-- END 상위 판매 테이블 -->

                </div><!-- END 카드6 header-left : 제목 + main : 상위 판매 테이블-->
              </div><!-- END 카드 디자인 -->
            </div>
            <!-- END 카드 6 : 판매 상위 제품 -->

          </div> <!-- END ROW -->
        </div><!-- End Left side columns : POST-CONTENT-->
      </div><!-- End ROW -->
    </section>
    <!-- END Left side columns : POST-CONTENT-->

  </main> <!-- End #main -->
</div><!-- End layout:fragment="content" -->

</html>